# Детали реализации проекта "Психологические тесты"

## Реализованные компоненты и функциональность

### 1. Структура проекта
Проект реализован с использованием React и TypeScript, со следующей структурой:

```
opros-v-3-0/
├── public/
│   ├── index.html
│   └── assets/
├── src/
│   ├── components/
│   │   ├── common/      # Общие компоненты (кнопки, формы и т.д.)
│   │   ├── layout/      # Компоненты разметки (шапка, подвал)
│   │   ├── pages/       # Страницы приложения
│   │   └── tests/       # Компоненты для тестов
│   ├── store/           # Redux хранилище
│   ├── utils/           # Утилиты и вспомогательные функции
│   ├── data/            # Данные тестов
│   ├── hooks/           # Пользовательские хуки
│   ├── types/           # TypeScript типы
│   ├── App.tsx
│   └── index.tsx
├── google-apps-script/  # Код для Google Apps Script
└── package.json
```

### 2. Страницы приложения

#### Главная страница (HomePage)
- Заголовок: "Привет! Меня зовут Таня, я учусь на клинического психолога"
- Приветственный текст: "Я очень рада, что вы согласились пройти мой опрос, который нужен мне, чтобы написать диплом. На заполнение опроса у вас уйдет примерно 30 минут."
- Информер с текстом: "Важно! При заполнении опроса внимательно читайте вводную часть и задание, чтобы ваши результаты были релевантными."
- Кнопка "Начать тестирование"

#### Анкета пользователя (ProfileForm)
- Форма с 8 полями для сбора демографической информации:
  - Возраст (числовое поле)
  - Пол (радио-кнопки)
  - Образование (выпадающий список)
  - Профессия (текстовое поле)
  - Семейное положение (выпадающий список)
  - Количество детей (числовое поле)
  - Регион проживания (текстовое поле)
  - Интересы (группа чекбоксов)
- Валидация всех полей
- Сохранение данных в Redux и localStorage

#### Контейнер для тестов (TestContainer)
- Динамическая загрузка тестов по ID
- Отображение заголовка и описания теста
- Навигация по страницам теста
- Сохранение ответов в Redux и localStorage
- Индикатор прогресса
- Кнопки "Назад" и "Далее"/"Следующий тест"/"Завершить"

#### Форма ввода email (EmailForm)
- Поле для ввода email
- Чекбокс согласия на обработку персональных данных
- Валидация email и согласия
- Отправка результатов в Google Sheets через API
- Индикатор загрузки во время отправки

#### Страница благодарности (ThankYouPage)
- Сообщение об успешной отправке результатов
- Информация о проверке почты
- Кнопка возврата на главную страницу

### 3. Общие компоненты

#### Компоненты форм
- **Button** - кнопка с поддержкой вариантов (primary/secondary)
- **FormInput** - текстовое поле с меткой и валидацией
- **Select** - выпадающий список с меткой и валидацией
- **RadioGroup** - группа радио-кнопок
- **CheckboxGroup** - группа чекбоксов с поддержкой ограничения выбора
- **TextArea** - многострочное текстовое поле с счетчиком символов
- **ScaleInput** - шкала для выбора числового значения

#### Компоненты разметки
- **Layout** - общая структура страницы
- **Header** - шапка сайта с логотипом
- **Footer** - подвал с копирайтом

#### Компоненты тестов
- **TestQuestion** - компонент для отображения вопросов разных типов
- **ProgressBar** - индикатор прогресса

### 4. Управление состоянием

#### Redux-хранилище
- **profileSlice** - хранение данных анкеты пользователя
- **answersSlice** - хранение ответов на тесты
- **sessionSlice** - управление сессией пользователя
- **navigationSlice** - хранение информации о текущей странице/тесте

#### Локальное хранилище
- Сохранение всего состояния в localStorage
- Восстановление состояния при перезагрузке страницы
- Отдельное хранение профиля, ответов и сессии

### 5. Управление сессией
- Генерация уникального идентификатора пользователя
- Отслеживание активности пользователя
- Продление сессии при активности
- Восстановление прогресса при возвращении пользователя
- Компонент SessionManager для управления сессией

### 6. Интеграция с Google Sheets
- Google Apps Script для приема данных
- Сохранение результатов в Google Sheets
- Отправка результатов на email пользователя
- API для взаимодействия между фронтендом и Google Apps Script

### 7. Типы данных
- Строгая типизация всех компонентов и функций
- Интерфейсы для профиля пользователя, тестов, вопросов, ответов и сессии
- Типы для различных видов вопросов (одиночный выбор, множественный выбор, шкала и т.д.)

### 8. Пользовательские хуки
- **useLocalStorage** - хук для работы с localStorage
- **useSessionTimeout** - хук для управления таймаутом сессии

## Особенности реализации

### Сохранение прогресса
- Автоматическое сохранение ответов после каждого изменения
- Сохранение текущей страницы и теста
- Восстановление с последней активной страницы при возвращении

### Валидация данных
- Проверка заполнения всех обязательных полей
- Валидация email и согласия на обработку данных
- Проверка ответов на все вопросы перед переходом к следующей странице

### Адаптивный дизайн
- Использование Styled Components для стилизации
- Адаптивная верстка для разных устройств
- Единый стиль для всех компонентов

### Обработка ошибок
- Отображение ошибок валидации
- Обработка ошибок при отправке данных
- Логирование ошибок в консоль

## Технические детали

### Используемые библиотеки
- **React** - библиотека для построения пользовательских интерфейсов
- **TypeScript** - типизированный JavaScript
- **React Router** - маршрутизация
- **Redux Toolkit** - управление состоянием
- **Styled Components** - стилизация компонентов
- **UUID** - генерация уникальных идентификаторов

### Структура данных тестов
- 7 последовательных тестов с различными типами вопросов
- Каждый тест состоит из одной или нескольких страниц
- Поддержка различных типов вопросов (одиночный выбор, множественный выбор, шкала, текст, матрица)

### Структура Google Sheets
- Лист "Responses" для хранения обработанных результатов
- Лист "Raw Data" для хранения полных данных в формате JSON
- Автоматическое создание листов при первом запуске

## Инструкции по запуску

### Локальная разработка
1. Клонировать репозиторий
2. Установить зависимости: `npm install`
3. Запустить приложение: `npm start`

### Настройка Google Apps Script
1. Создать новую Google таблицу
2. Открыть редактор скриптов (Расширения > Apps Script)
3. Скопировать код из файла `google-apps-script/Code.gs` в редактор
4. Заменить значения констант `API_KEY` и `SHEET_ID` на свои
5. Опубликовать скрипт как веб-приложение
6. Скопировать URL веб-приложения и вставить его в файл `src/utils/api.ts`

### Сборка для продакшена
1. Выполнить команду: `npm run build`
2. Разместить содержимое папки `build` на хостинге

## Дальнейшее развитие проекта

### Возможные улучшения
- Добавление аутентификации пользователей
- Расширение аналитики результатов
- Добавление возможности сохранения PDF-отчета
- Интеграция с другими системами
- Многоязычная поддержка
